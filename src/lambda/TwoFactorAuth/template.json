{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Transform": "AWS::Serverless-2016-10-31",
  "Description": "A sample SAM template for deploying Lambda functions",

  "Parameters": {
    "ACCOUNTSID": {
      "Description": "Twilio Account SID (is required)",
      "Type": "String"
    },
    "AUTHTOKEN": {
      "Description": "Twilio Token Auth (is required)",
      "Type": "String"
    }
  },

  "Resources": {
    "Bucket": {
      "Type": "AWS::S3::Bucket",
      "Properties" {
        "BucketName": "codeUri"
      }
    },
    "check2FaTokenFunc": {
      "Type": "AWS::Serverless::Function",
      "Properties": {
        "FunctionName": "check2FaTokenFunc",
        "Description": "DynamoDB check record",
        "Handler": "check2FaTokenFunc/index.handler",
        "Runtime": "nodejs12.x",
        "MemorySize": 128,
        "Timeout": 15
      }
    },
    "generate2FaTokenFunc": {
      "Type": "AWS::Serverless::Function",
      "Properties": {
        "FunctionName": "generate2FaTokenFunc",
        "Description": "Twilio send message and create a token",
        "Handler": "generate2FaTokenFunc/index.handler",
        "Runtime": "nodejs12.x",
        "MemorySize": 256,
        "Timeout": 20
      }
    },
    "lookupPhoneNumberFunc": {
      "Type": "AWS::Serverless::Function",
      "Properties": {
        "FunctionName": "lookupPhoneNumberFunc",
        "Description": "Twilio lookup phone number",
        "Handler": "lookupPhoneNumberFunc/index.handler",
        "Environment": {
          "sid": {
            "Ref": "ACCOUNTSID"
          },
          "token": {
            "Ref": "AUTHTOKEN"
          }
        },
        "Runtime": "nodejs12.x",
        "MemorySize": 128,
        "Timeout": 15
      }
    }
  }
}
